<!-- @if (isLoading) {
  <div class="loading-shade-full w-full h-full" style="background: rgba(0, 0, 0, 0.12) !important">
    <mat-spinner></mat-spinner>
  </div>
} -->
<mat-toolbar>
  @if (!selection.selected.length && !showFilterAboutUs) {
    <mat-toolbar-row>
      <div class="flex flex-row justify-between items-center w-full">
        <div>
          <span class="mat-title mb-0 xs:hidden">{{ 'Lista de películas' }}</span>
          <span class="mat-title mb-0 hidden xs:inline">{{ 'Películas' }}</span>
        </div>
        <div class="xs:hidden">
          <button mat-button (click)="refreshData()">
            <mat-icon>refresh</mat-icon>
            <span class="xs:hidden">{{ 'Refrescar' }}</span>
          </button>
          <button mat-button (click)="onCreateMovie()">
            <mat-icon>add</mat-icon>
            <span class="xs:hidden">{{ 'Adicionar' }}</span>
          </button>
        </div>
        <div class="hidden xs:inline">
          <button mat-icon-button (click)="refreshData()">
            <mat-icon>refresh</mat-icon>
          </button>
          <button mat-icon-button (click)="onCreateMovie()">
            <mat-icon>add</mat-icon>
          </button>
        </div>
      </div>
    </mat-toolbar-row>
  }
  @if (selection.selected.length) {
    <mat-toolbar-row>
      <div class="flex flex-row justify-between items-center w-100">
        <div class="xs:hidden">
          <span class="mat-title mb-0">{{ selection.selected.length }}</span>
          <span class="ml-2 mat-title mb-0">{{ 'elementos seleccionados' }}</span>
        </div>
        <div>
          @if (selection.selected.length == 1) {
            <button mat-button (click)="onEditMovie(selection.selected[0])">
              <mat-icon>edit</mat-icon>
              <span class="xs:hidden">{{ 'Editar' }}</span>
            </button>
          }
          @if (selection.selected.length >= 1) {
            <button mat-button (click)="onRemoveMovies(selection.selected)">
              <mat-icon>remove</mat-icon>
              <span class="xs:hidden">{{ 'Eliminar' }}</span>
            </button>
          }
        </div>
      </div>
    </mat-toolbar-row>
  }
</mat-toolbar>

<div class="responsive_table">
  <table mat-table [dataSource]="dataSource">
    <ng-container matColumnDef="select">
      <th style="width: 7%" mat-header-cell *matHeaderCellDef>
        <div class="flex flex-col justify-start items-start">
          <mat-checkbox
            (change)="$event ? masterToggle() : null"
            [checked]="selection.hasValue() && isAllSelected()"
            [indeterminate]="selection.hasValue() && !isAllSelected()"
            [aria-label]="checkboxLabel()"
          >
          </mat-checkbox>
        </div>
      </th>
      <td mat-cell *matCellDef="let row">
        <div class="flex flex-col justify-start items-start" fxLayoutAlign="start start">
          <mat-checkbox
            (click)="$event.stopPropagation()"
            (change)="$event ? selection.toggle(row) : null"
            [checked]="selection.isSelected(row)"
            [aria-label]="checkboxLabel(row)"
          >
          </mat-checkbox>
        </div>
      </td>
    </ng-container>

    <ng-container matColumnDef="title">
      <th mat-header-cell *matHeaderCellDef>
        <span class="mat-body-2" style="text-transform: capitalize">{{ 'Título' }}</span>
      </th>
      <td mat-cell *matCellDef="let element">
        <span class="mat-body-1"> {{ element.name }}</span>
      </td>
    </ng-container>

    <ng-container matColumnDef="description">
      <th mat-header-cell *matHeaderCellDef>
        <span class="mat-body-2" style="text-transform: capitalize">{{ 'Descripción' }}</span>
      </th>
      <td mat-cell *matCellDef="let element">
        <span class="mat-body-1"> {{ element.description }}</span>
      </td>
    </ng-container>

    <ng-container matColumnDef="duration">
      <th mat-header-cell *matHeaderCellDef>
        <span class="mat-body-2" style="text-transform: capitalize">{{ 'Duración' }}</span>
      </th>
      <td mat-cell *matCellDef="let element">
        <span class="mat-body-1"> {{ element.duration }}</span>
      </td>
    </ng-container>

    <ng-container matColumnDef="premier">
      <th mat-header-cell *matHeaderCellDef>
        <span class="mat-body-2" style="text-transform: capitalize">{{ 'Estreno' }}</span>
      </th>
      <td mat-cell *matCellDef="let element">
        <span class="mat-body-1"> {{ element.premiere | date }}</span>
      </td>
    </ng-container>

    <ng-container matColumnDef="genre">
      <th mat-header-cell *matHeaderCellDef>
        <span class="mat-body-2">{{ 'Géneros' }}</span>
      </th>
      <td mat-cell *matCellDef="let element">
        <ul class="list-disc list-outside">
          @for (genre of element.genres; track $index) {
            <li>
              <span class="mat-body-1"> {{ genre.name }}</span>
            </li>
          }
        </ul>
      </td>
    </ng-container>

    <ng-container matColumnDef="country">
      <th mat-header-cell *matHeaderCellDef>
        <span class="mat-body-2">{{ 'Países' }}</span>
      </th>
      <td mat-cell *matCellDef="let element">
        <ul class="list-disc list-outside">
          @for (country of element.countries; track $index) {
            <li>
              <span class="mat-body-1"> {{ country.name }}</span>
            </li>
          }
        </ul>
      </td>
    </ng-container>

    <ng-container matColumnDef="director">
      <th mat-header-cell *matHeaderCellDef>
        <span class="mat-body-2">{{ 'Directores' }}</span>
      </th>
      <td mat-cell *matCellDef="let element">
        <ul class="list-disc list-outside">
          @for (director of element.directors; track $index) {
            <li>
              <span class="mat-body-1">{{ director.firstName }} {{ director.lastName }}</span>
            </li>
          }
        </ul>
      </td>
    </ng-container>

    <ng-container matColumnDef="actor">
      <th mat-header-cell *matHeaderCellDef>
        <span class="mat-body-2">{{ 'Actores' }}</span>
      </th>
      <td mat-cell *matCellDef="let element">
        <ul class="list-disc list-outside">
          @for (actor of element.actors; track $index) {
            <li>
              <span class="mat-body-1">{{ actor.firstName }} {{ actor.lastName }}</span>
            </li>
          }
        </ul>
      </td>
    </ng-container>

    <ng-container matColumnDef="actions">
      <th style="width: 3%; overflow: hidden" mat-header-cell *matHeaderCellDef></th>
      <td mat-cell *matCellDef="let element">
        <div style="width: 104px" id="actionsHover" class="flex flex-row justify-end items-center">
          @if (element.featured === 1) {
            <button matTooltip="{{ 'Editar' }}" (click)="onEditMovie(element)" mat-icon-button>
              <mat-icon>edit</mat-icon>
            </button>
            <button matTooltip="{{ 'Remover' }}" (click)="onRemoveMovies([element])" mat-icon-button>
              <mat-icon>delete</mat-icon>
            </button>
          }
        </div>
      </td>
    </ng-container>

    <!-- filters -->
    <!-- Checkbox Column -->
    <ng-container matColumnDef="selectF">
      <th style="width: 5%" mat-header-cell *matHeaderCellDef></th>
    </ng-container>

    <ng-container matColumnDef="titleF">
      <!-- <th mat-header-cell *matHeaderCellDef>
        <mat-form-field class="remove-material-form-padding-bottom" style="width: 156px; margin-right: 8px" appearance="outline">
          <mat-label style="text-transform: capitalize"> {{ 'Titulo' }}</mat-label>
          <input type="text" matInput [formControl]="formFilters.controls['summary']" placeholder="{{ 'Titulo' }}" />
          <button *ngIf="formFilters.get('summary')?.value" matSuffix mat-icon-button (click)="formFilters.get('summary')?.reset()">
            <mat-icon> clear </mat-icon>
          </button>
        </mat-form-field>
      </th> -->
    </ng-container>

    <ng-container matColumnDef="actionsF">
      <th mat-header-cell *matHeaderCellDef></th>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <!-- <tr class="static-column" mat-header-row *matHeaderRowDef="displayedColumnsFilters"></tr> -->
    <tr mat-row class="rowData" *matRowDef="let row; columns: displayedColumns" (mouseover)="row.featured = 1" (mouseleave)="row.featured = 0"></tr>
  </table>
  <mat-paginator (page)="OnPaginatorChange($event)" [pageSize]="query.limit" [length]="this.query.total" [pageSizeOptions]="pageSizeOptions"></mat-paginator>
</div>
